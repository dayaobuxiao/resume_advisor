{% extends 'base.html' %}

{% block title %}{% if resume %}Edit{% else %}New{% endif %} Resume - Resume Advisor{% endblock %}

{% block content %}
<h2>{% if resume %}Edit{% else %}New{% endif %} Resume</h2>

<!-- back to board -->
<a href="{% url 'dashboard' %}" class="back-button">Back to Dashboard</a>

<form id="resume-form" method="POST">
    {% csrf_token %}

    <div id="nameError" style="color: red;"></div>
    <label for="resume-name">Resume Name:</label>
    <input type="text" id="resume-name" name="name" value="{{ resume.name|default:'' }}" required>

    <div id="sections-container">
        {% for section in sections %}
        <div class="resume-section">
            <label for="section-title-{{ forloop.counter0 }}">Section Title:</label>
            <input type="text" id="section-title-{{ forloop.counter0 }}" class="section-title" name="section-title-{{ forloop.counter0 }}" value="{{ section.title }}" required>

            <label for="section-content-{{ forloop.counter0 }}">Content:</label>
            <textarea id="section-content-{{ forloop.counter0 }}" class="section-content" name="section-content-{{ forloop.counter0 }}" required>{{ section.content }}</textarea>

            <label for="section-analysis-{{ forloop.counter0 }}">Analysis:</label>
            <div id="section-analysis-{{ forloop.counter0 }}" class="section-analysis" readonly>{{ section.analysis }}</div>
            <input type="hidden" id="section-analysis-input-{{ forloop.counter0 }}" name="section-analysis-{{ forloop.counter0 }}" value="{{ section.analysis }}">
            <button type="button" class="delete-section" data-section-id="{{ forloop.counter0 }}">Delete Section</button>
        </div>
        {% endfor %}
    </div>

    <button type="button" id="add-section">Add Section</button>
    <button type="submit">Save Resume</button>

    {% if resume %}
    <button type="button" id="analyze-resume">Analyze Resume</button>
    {% endif %}
</form>

{% endblock %}